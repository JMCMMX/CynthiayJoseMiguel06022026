<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Encuentra tu mesa</title>
  <style>
    :root{
      --bg:#fbfaf8;
      --ink:#243040;
      --muted:#6b7686;
      --line:rgba(36,48,64,.18);
      --accent:#cbbba5;
      --accent2:#5aa7c7;

      --shadow: 0 18px 35px rgba(0,0,0,.10);
      --shadow2: 0 10px 22px rgba(0,0,0,.08);

      --canvasW: 1100px;
      --canvasH: 640px;
      --mesaSize: 60px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:
        radial-gradient(900px 420px at 50% 0%, rgba(203,187,165,.22), transparent 60%),
        radial-gradient(700px 420px at 90% 10%, rgba(90,167,199,.12), transparent 60%),
        var(--bg);
      color:var(--ink);
    }

    header{
      position:sticky; top:0; z-index:10;
      background: rgba(251,250,248,.82);
      border-bottom:1px solid var(--line);
      backdrop-filter: blur(10px);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:14px 16px}
    .title{font-weight:800;letter-spacing:.2px}
    .sub{color:var(--muted);font-size:13px;margin-top:2px}

    .searchRow{
      margin-top:10px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .input{
      flex:1;
      min-width:240px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.75);
      outline:none;
      font-size:14px;
    }
    .input:focus{
      border-color: rgba(203,187,165,.9);
      box-shadow:0 0 0 4px rgba(203,187,165,.20);
    }
    .btn{
      padding:12px 14px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.75);
      cursor:pointer;
      font-weight:700;
    }
    .btn:hover{background:rgba(203,187,165,.18)}
    .hint{color:var(--muted);font-size:12px;margin-top:8px}

    main{max-width:1100px;margin:0 auto;padding:14px 16px 26px}

    .stageWrap{
      overflow-x:auto;
      padding: 6px 10px 12px;
    }

    .stage{
      position:relative;
      width:var(--canvasW);
      height:var(--canvasH);
      border-radius:22px;

      /* ✅ Fondo con tu SVG */
      background-color: rgba(255,255,255,.35);
      background-image: url("./Layout.svg");
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;

      margin: 0 auto;

      /* ✅ IMPORTANTE: el zoom ahora se aplica por JS (translate + scale) */
      transform-origin:center;
      transition: transform .7s cubic-bezier(.2,.85,.2,1);
      will-change: transform;
    }

    /* Mesas */
    .mesa{
      position:absolute;
      left: var(--x);
      top: var(--y);
      transform: translate(-50%, -50%);
      width: var(--mesaSize);
      height: var(--mesaSize);
      border-radius: 999px;
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(203,187,165,.90);
      box-shadow: var(--shadow2);
      overflow:hidden;
      transition:
        transform .7s cubic-bezier(.2,.85,.2,1),
        opacity .25s ease,
        filter .25s ease;
    }

    .mesaHead{
      height: 28px;
      display:flex; align-items:center; justify-content:space-between;
      padding: 6px 10px;
      background: linear-gradient(90deg, rgba(90,167,199,.20), rgba(203,187,165,.18));
      border-bottom: 1px solid rgba(36,48,64,.10);
      font-size: 12px;
      letter-spacing: 2px;
      color: rgba(36,48,64,.78);
      user-select:none;
    }
    .mesaHead b{text-transform:uppercase}
    .mesaBody{
      padding: 8px 10px 10px;
      height: calc(100% - 28px);
      overflow:auto;
    }
    .chip{
      font-size: 12px;
      padding: 6px 8px;
      border: 1px solid rgba(36,48,64,.10);
      background: rgba(247,244,239,.75);
      border-radius: 999px;
      margin-bottom: 6px;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow:hidden;
    }
    .chip:last-child{margin-bottom:0}

    /* Modo “focus”: oculta todo excepto la mesa objetivo */
    .stage.is-focus .mesa{
      opacity:.08;
      filter: blur(0.2px) grayscale(.2);
      pointer-events:none;
    }
    .stage.is-focus .mesa.is-target{
      opacity:1;
      filter:none;
      pointer-events:auto;
      transform: translate(-50%, -50%) scale(1.25);
      outline: 3px solid rgba(90,167,199,.55);
      outline-offset: 6px;
      box-shadow: 0 26px 46px rgba(0,0,0,.16);
      z-index: 5;
    }

    .resultBar{
      margin-top:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.65);
      border-radius: 16px;
      padding: 10px 12px;
      display:none;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .resultBar.show{display:flex}
    .resultBar .left{
      display:flex; flex-direction:column; gap:2px;
    }
    .resultBar .left b{letter-spacing:.3px}
    .resultBar .left small{color:var(--muted)}
    .resultBar .right{display:flex; gap:10px; align-items:center}

    .toast{
      position:fixed; right:16px; bottom:16px;
      max-width:360px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow2);
      color: rgba(36,48,64,.92);
      display:none;
      z-index: 50;
    }
    /* chips grandes para el modal */
.mmChip{
  font-size: 14px;
  padding: 10px 12px;
  border: 1px solid rgba(36,48,64,.12);
  background: rgba(247,244,239,.9);
  border-radius: 999px;
  margin-bottom: 10px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.mmChip:last-child{ margin-bottom:0; }

  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="title">Encuentra tu mesa</div>
      <div class="sub">Escribe tu nombre igual que como confirmaste desde tu invitación. Se mostrará únicamente tu mesa y los invitados de esa mesa.</div>

      <div class="searchRow">
        <input id="nameInput" class="input" type="search" placeholder="Ej. Esmeralda Del Valle Hernandez" autocomplete="off" />
        <button id="btnFind" class="btn" type="button">Buscar</button>
        <button id="btnReset" class="btn" type="button">Ver plano</button>
      </div>
      <div class="hint">Tip: el buscador ignora acentos. Si no te encuentra, prueba con otro apellido o sin segundo nombre.</div>

      <div id="resultBar" class="resultBar">
        <div class="left">
          <b id="rbTitle">Mesa</b>
          <small id="rbSub">—</small>
        </div>
        <div class="right">
          <button id="btnBack" class="btn" type="button">Cambiar nombre</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="stageWrap" id="stageWrap">
      <div id="stage" class="stage">

        <!-- NO CAMBIAR COORDENADAS -->
        <div class="mesa" data-mesa="6" style="--x: 40%; --y: 50%;"></div>
        <div class="mesa" data-mesa="5" style="--x: 48%; --y: 45%;"></div>
        <div class="mesa" data-mesa="9" style="--x: 58%; --y: 43%;"></div>

        <div class="mesa" data-mesa="4" style="--x: 37%; --y: 62%;"></div>
        <div class="mesa" data-mesa="3" style="--x: 56%; --y: 55%;"></div>
        <div class="mesa" data-mesa="7" style="--x: 63%; --y: 53%;"></div>
        <div class="mesa" data-mesa="1" style="--x: 60%; --y: 63%;"></div>

        <div class="mesa" data-mesa="2" style="--x: 41%; --y: 75%"></div>
        <div class="mesa" data-mesa="8" style="--x: 33%; --y: 72%;"></div>
        <!-- /NO CAMBIAR COORDENADAS -->

      </div>
    </div>

    <div class="hint" style="max-width:1100px;margin:10px auto 0;padding:0 16px;">
      * Esta vista es informativa. La asignación final puede ajustarse por logística del evento.
    </div>
  </main>

  <div id="toast" class="toast"></div>
<!-- Modal Mesa -->
<div id="mesaModalBackdrop" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.35); z-index:60;"></div>

<div id="mesaModal" style="display:none; position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
  width:min(560px, 92vw); max-height:min(70vh, 520px);
  background:rgba(255,255,255,.96); border:1px solid rgba(36,48,64,.18);
  border-radius:18px; box-shadow:0 26px 60px rgba(0,0,0,.22);
  z-index:61; overflow:hidden;">
  <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;
    padding:12px 14px; border-bottom:1px solid rgba(36,48,64,.12);">
    <div>
      <div id="mmTitle" style="font-weight:900; letter-spacing:.4px;">Mesa</div>
      <div id="mmSub" style="font-size:12px; color:#6b7686; margin-top:2px;">—</div>
    </div>
    <button id="mmClose" class="btn" type="button">Cerrar</button>
  </div>

  <div id="mmList" style="padding:12px 14px; overflow:auto; max-height:calc(70vh - 70px);">
    <!-- chips -->
  </div>
</div>

  <script>
    /********************
     * DATOS (TU LISTA)
     ********************/
    const GUESTS = [
      { nombre: "Angelica Perez", mesa: "1" },
      { nombre: "Antonio De Jesús De La Luz", mesa: "1" },
      { nombre: "Carmen Dominguez Rios", mesa: "1" },
      { nombre: "Hilda Pérez García", mesa: "1" },
      { nombre: "Jorge Escobar Ortega", mesa: "1" },
      { nombre: "Jose Cruz De Jesús De La Luz", mesa: "1" },
      { nombre: "Karla Erika Escobar Osorio", mesa: "1" },
      { nombre: "María De La Luz Montiel", mesa: "1" },
      { nombre: "Nayeli Lopez Suarez", mesa: "1" },
      { nombre: "Rocio Isabel Palafox", mesa: "1" },

      { nombre: "Anahiz Rojas Serrano", mesa: "2" },
      { nombre: "Ariadna Camilo Modesto", mesa: "2" },
      { nombre: "Blanca Modesto Rodriguez", mesa: "2" },
      { nombre: "Daniel Castrillo Modesto", mesa: "2" },
      { nombre: "Erik Santiago Amador Modesto", mesa: "2" },
      { nombre: "Luis Angel Camilo Modesto", mesa: "2" },
      { nombre: "Miriam Modesto Peralta", mesa: "2" },
      { nombre: "Olivia Modesto Rodriguez", mesa: "2" },
      { nombre: "Vicente Castrillo Oropeza", mesa: "2" },

      { nombre: "Antonio Del Valle Hernandez", mesa: "3" },
      { nombre: "David Lopez Del Valle", mesa: "3" },
      { nombre: "Esmeralda Del Valle Hernandez", mesa: "3" },
      { nombre: "Gregorio De Jesús De La Luz", mesa: "3" },
      { nombre: "Gustavo Del Valle Hernandez", mesa: "3" },
      { nombre: "Gustavo Isaí Del Valle Becerril", mesa: "3" },
      { nombre: "Hanna Jatziri Del Valle Becerril", mesa: "3" },
      { nombre: "Isabella Rosas Lopez", mesa: "3" },
      { nombre: "Karina Del Valle Hernandez", mesa: "3" },
      { nombre: "Nathalia Lucia Del Valle Becerril.", mesa: "3" },
      { nombre: "Regina Lopez Del Valle", mesa: "3" },

      { nombre: "Alejandra Rosas Zepeda", mesa: "4" },
      { nombre: "Brenda Fabiola Garcia Velazquez", mesa: "4" },
      { nombre: "Itzel Juarez", mesa: "4" },
      { nombre: "José Leonardo Cortes Mora", mesa: "4" },
      { nombre: "Luis Modesto Rodriguez", mesa: "4" },
      { nombre: "María Maribel Peralta González", mesa: "4" },
      { nombre: "Miguel Angel Modesto Rodriguez", mesa: "4" },
      { nombre: "Nancy Valentín Ortega", mesa: "4" },
      { nombre: "Pesce Soria Aiko Romina", mesa: "4" },
      { nombre: "Roberto Modesto Rodriguez", mesa: "4" },

      { nombre: "Alejandra Villa Cruz", mesa: "5" },
      { nombre: "Angel García De Jesús", mesa: "5" },
      { nombre: "Cristina Rubio Morquecho", mesa: "5" },
      { nombre: "Mariel  De Jesús Villa", mesa: "5" },
      { nombre: "Mario De Jesus De La Luz", mesa: "5" },
      { nombre: "Nancy Lopez", mesa: "5" },
      { nombre: "Pedro De Jesús De La Luz", mesa: "5" },
      { nombre: "Shara Damiana De Jesús Villa", mesa: "5" },

      { nombre: "Ana De la Luz", mesa: "6" },
      { nombre: "Diego De Jesus Lopez", mesa: "6" },
      { nombre: "Jhoseline Daniela Bernal Cruz", mesa: "6" },
      { nombre: "Josue Gabriel De Jesús Del Valle", mesa: "6" },
      { nombre: "Karla De Jesus Lopez", mesa: "6" },
      { nombre: "Lucio Alberto De Jesús Domínguez", mesa: "6" },
      { nombre: "Marco Antonio De Jesús Domínguez", mesa: "6" },
      { nombre: "Ximena De Jesús Del Valle", mesa: "6" },
      { nombre: "Yair De Jesus Lopez", mesa: "6" },
      { nombre: "Yuritzi De Jesus Gutierrez", mesa: "6" },

      { nombre: "Alicia Vargas Franco", mesa: "7" },
      { nombre: "Alonso Mendez Serrano", mesa: "7" },
      { nombre: "Camille Danie Philadelphie Desirée Delamare", mesa: "7" },
      { nombre: "Elías Rodriguez Cortez", mesa: "7" },
      { nombre: "Esaú Eduardo Vargas", mesa: "7" },
      { nombre: "Fabián Alejandro Martínez García", mesa: "7" },
      { nombre: "Gibran Jaimes", mesa: "7" },
      { nombre: "Irene Margarita Cortez Melendrez", mesa: "7" },
      { nombre: "Johana Estela Rojas", mesa: "7" },
      { nombre: "Roberto Rodríguez Rios", mesa: "7" },

      { nombre: "Erika Meza", mesa: "8" },
      { nombre: "Felicitas Damian", mesa: "8" },
      { nombre: "Guadalupe Aponce", mesa: "8" },
      { nombre: "Jose Armando Meza Cortes", mesa: "8" },
      { nombre: "Laura Gómez", mesa: "8" },
      { nombre: "Leonardo Mayen De Jesus", mesa: "8" },
      { nombre: "Monica De Jesus Aponce", mesa: "8" },
      { nombre: "Polo De Jesús Sanchez", mesa: "8" },
      { nombre: "Rocío De Jesus Aponce", mesa: "8" },
      { nombre: "Vania Mayen De Jesus", mesa: "8" },

      { nombre: "Annahí Echeverria Benitez", mesa: "9" },
      { nombre: "Augustė Volungevičiūtė", mesa: "9" },
      { nombre: "Carlos Eduardo De Leon Cantu", mesa: "9" },
      { nombre: "Carlos Fernando Merlos", mesa: "9" },
      { nombre: "Edna castaños sepulveda", mesa: "9" },
      { nombre: "Juan Pablo Loza Andrade", mesa: "9" },
      { nombre: "Liliana Nohemí Gaytan de la Rosa", mesa: "9" },
      { nombre: "Sebastian Solis", mesa: "9" },
      { nombre: "Sebastién Montagnion", mesa: "9" },
      { nombre: "Valerian André Henri Lenud", mesa: "9" },

      { nombre: "Cynthia De Jesus Dominguez", mesa: "Novios" },
      { nombre: "Jose Miguel Castrillo Modesto", mesa: "Novios" }
    ];

    /********************
     * UTIL
     ********************/
    const nameInput = document.getElementById('nameInput');
    const btnFind = document.getElementById('btnFind');
    const btnReset = document.getElementById('btnReset');
    const btnBack = document.getElementById('btnBack');
    const toastEl = document.getElementById('toast');
    const stage = document.getElementById('stage');
    const stageWrap = document.getElementById('stageWrap');

    const resultBar = document.getElementById('resultBar');
    const rbTitle = document.getElementById('rbTitle');
    const rbSub = document.getElementById('rbSub');
const mesaModal = document.getElementById('mesaModal');
const mesaModalBackdrop = document.getElementById('mesaModalBackdrop');
const mmTitle = document.getElementById('mmTitle');
const mmSub = document.getElementById('mmSub');
const mmList = document.getElementById('mmList');
const mmClose = document.getElementById('mmClose');

function openMesaModal(mesa){
  const names = byMesa.get(mesa) || [];
  mmTitle.textContent = `Mesa ${mesa}`;
  mmSub.textContent = `${names.length} invitado(s)`;
  mmList.innerHTML = names.map(n => `<div class="mmChip">${esc(n)}</div>`).join('');

  mesaModalBackdrop.style.display = 'block';
  mesaModal.style.display = 'block';
}

function closeMesaModal(){
  mesaModalBackdrop.style.display = 'none';
  mesaModal.style.display = 'none';
}

mmClose.addEventListener('click', closeMesaModal);
mesaModalBackdrop.addEventListener('click', closeMesaModal);
document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeMesaModal(); });

    function norm(s){
      return (s||'')
        .toString()
        .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
        .toLowerCase()
        .trim()
        .replace(/\s+/g,' ');
    }
    function esc(s){
      return (s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[c]));
    }
    function toast(msg){
      toastEl.textContent = msg;
      toastEl.style.display = 'block';
      clearTimeout(window.__t);
      window.__t = setTimeout(()=>toastEl.style.display='none', 2200);
    }

    // ✅ ZOOM: centra la mesa y hace zoom al escenario
    // Ajusta ZOOM_SCALE si quieres más/menos acercamiento.
    const ZOOM_SCALE = 2.2;

    function zoomToElement(el){
      if(!el) return;

      // Forzar que el contenedor sea visible en viewport (por si hay scroll vertical)
      stageWrap.scrollIntoView({ behavior:'smooth', block:'start', inline:'nearest' });

      // Medidas reales en pantalla (sin transform aplicado aún)
      const wrapRect = stageWrap.getBoundingClientRect();
      const stageRect = stage.getBoundingClientRect();
      const elRect = el.getBoundingClientRect();

      // Centro visible del contenedor (viewport del wrap)
      const wrapCenterX = wrapRect.left + wrapRect.width / 2;
      const wrapCenterY = wrapRect.top + wrapRect.height / 2;

      // Centro del elemento
      const elCenterX = elRect.left + elRect.width / 2;
      const elCenterY = elRect.top + elRect.height / 2;

      // Diferencia en píxeles (lo que hay que mover para centrar)
      const dx = wrapCenterX - elCenterX;
      const dy = wrapCenterY - elCenterY;

      // Aplicar transform al stage (translate + scale)
      stage.style.transform = `translate(${dx}px, ${dy}px) scale(${ZOOM_SCALE})`;
    }

    function resetZoom(){
      stage.style.transform = 'translate(0px, 0px) scale(1)';
    }

    // Index por mesa
    const byMesa = new Map();
    const flat = [];
    for(const g of GUESTS){
      const n = (g.nombre||'').trim();
      const m = (g.mesa||'').trim();
      if(!n) continue;
      if(!byMesa.has(m)) byMesa.set(m, []);
      byMesa.get(m).push(n);
      flat.push({nombre:n, mesa:m, key:norm(n)});
    }
    for(const [m, arr] of byMesa.entries()){
      arr.sort((a,b)=>a.localeCompare(b,'es',{sensitivity:'base'}));
    }

    // Render inicial: todas las mesas con placeholders mínimos (sin nombres)
    function renderAllEmpty(){
      document.querySelectorAll('.mesa[data-mesa]').forEach(el=>{
        const m = el.getAttribute('data-mesa');
        el.classList.remove('is-target');
        el.innerHTML = `
          <div class="mesaHead"><b>Mesa ${esc(m)}</b><span></span></div>
          <div class="mesaBody">
            <div class="chip" style="opacity:.55">—</div>
          </div>
        `;
      });
    }

    // Render solo la mesa objetivo con sus nombres
    function renderMesa(mesa){
      const target = document.querySelector(`.mesa[data-mesa="${mesa}"]`);
      if(!target) return;

      // vaciar otras mesas (solo placeholder)
      document.querySelectorAll('.mesa[data-mesa]').forEach(el=>{
        const m = el.getAttribute('data-mesa');
        if(m !== mesa){
          el.classList.remove('is-target');
          el.innerHTML = `
            <div class="mesaHead"><b>Mesa ${esc(m)}</b><span></span></div>
            <div class="mesaBody"><div class="chip" style="opacity:.55">—</div></div>
          `;
        }
      });

      const names = byMesa.get(mesa) || [];
      target.classList.add('is-target');
      target.innerHTML = `
        <div class="mesaHead">
          <b>Mesa ${esc(mesa)}</b>
          <span>${names.length} invitado(s)</span>
        </div>
        <div class="mesaBody">
          ${names.map(n => `<div class="chip">${esc(n)}</div>`).join('')}
        </div>
      `;
    }

    function focusOnMesa(mesa){
      stage.classList.add('is-focus');
      renderMesa(mesa);

      const target = document.querySelector(`.mesa[data-mesa="${mesa}"]`);
      if(target){
        // Primero: asegurar que esté dentro del scroll horizontal
        target.scrollIntoView({behavior:'smooth', block:'center', inline:'center'});

        // Luego: aplicar zoom centrado (espera un tick para que scrollIntoView termine)
        setTimeout(()=> zoomToElement(target), 250);
      }

      rbTitle.textContent = `Mesa ${mesa}`;
      rbSub.textContent = `Se muestran solo los invitados de tu mesa.`;
      resultBar.classList.add('show');
      openMesaModal(mesa);

    }

    function resetView(){
      stage.classList.remove('is-focus');
      resultBar.classList.remove('show');
      renderAllEmpty();
      resetZoom();
      closeMesaModal();

    }

    function find(){
      const q = norm(nameInput.value);
      if(!q){
        toast('Escribe tu nombre.');
        return;
      }

      let person = flat.find(x => x.key === q);
      if(!person){
        person = flat.find(x => x.key.includes(q));
      }

      if(!person){
        toast('No encontramos tu nombre. Prueba con otro apellido o sin acentos.');
        return;
      }

      if(norm(person.mesa) === norm('Novios')){
        toast('Mesa: Novios');
        rbTitle.textContent = 'Mesa de Novios';
        rbSub.textContent = 'Consulta con los organizadores si aplica.';
        resultBar.classList.add('show');
        stage.classList.remove('is-focus');
        renderAllEmpty();
        resetZoom();
        return;
      }

      focusOnMesa(person.mesa);
    }

    // Events
    btnFind.addEventListener('click', find);
    nameInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') find(); });

    btnReset.addEventListener('click', ()=>{ nameInput.value=''; resetView(); });
    btnBack.addEventListener('click', ()=>{
      stage.classList.remove('is-focus');
      resultBar.classList.remove('show');
      nameInput.focus();
      renderAllEmpty();
      resetZoom();
    });

    // init
    renderAllEmpty();
    resetZoom();
  </script>
  
</body>
</html>

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Tarifas - Boda Cynthia y Jose Miguel</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Lato:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>

    <div class="staggered-menu-wrapper">
        <div class="sm-prelayers" aria-hidden="true">
            <div class="sm-prelayer" style="background: #2F4667;"></div>
            <div class="sm-prelayer" style="background: #A3ADA0;"></div>
            <div class="sm-prelayer" style="background: #E6DECF;"></div>
        </div>
        <header class="staggered-menu-header">
            <a href="index.html" class="sm-logo" aria-label="Homepage"><span class="sm-logo-text">C & JM</span></a>
            <button class="sm-toggle" aria-label="Abrir menú" aria-expanded="false" aria-controls="staggered-menu-panel" type="button">
                <span class="sm-toggle-textWrap" aria-hidden="true"><span class="sm-toggle-textInner"></span></span>
                <span class="sm-icon" aria-hidden="true"><span class="sm-icon-line"></span><span class="sm-icon-line sm-icon-line-v"></span></span>
            </button>
        </header>
        <aside id="staggered-menu-panel" class="staggered-menu-panel" aria-hidden="true">
            <div class="sm-panel-inner">
                <ul class="sm-panel-list" role="list">
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="index.html"><span class="sm-panel-itemLabel">Homepage</span></a></li>
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="fecha-hora.html"><span class="sm-panel-itemLabel">Fecha y Hora</span></a></li>
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="lugar.html"><span class="sm-panel-itemLabel">El Lugar</span></a></li>
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="hospedaje.html"><span class="sm-panel-itemLabel">Hospedaje</span></a></li>
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="vuelos.html"><span class="sm-panel-itemLabel">Vuelos</span></a></li>
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="regalos.html"><span class="sm-panel-itemLabel">Regalos</span></a></li>
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="Time.html"><span class="sm-panel-itemLabel">Cuenta Regresiva</span></a></li>
                    <li class="sm-panel-itemWrap"><a class="sm-panel-item" href="calculadora.html"><span class="sm-panel-itemLabel">Calculadora de tarifas</span></a></li>
                </ul>
            </div>
        </aside>
    </div>

    <div class="contenido-pagina calculadora-wrapper">
        <h1>Calculadora Estimada de Tarifas</h1>
        <p class="introduccion-calculadora">
            Estimación basada en las <strong>tarifas grupales de nuestro contrato</strong> en Hotel Xcaret (All-Fun Inclusive®, impuestos incluidos).
            Selecciona categoría, fechas y ocupación por habitación. <em>Ocupación máxima: 4 personas por habitación.</em>
        </p>

        <div class="calculadora-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="categoria"><i class="fa-solid fa-hotel"></i> Categoría Habitación:</label>
                    <select id="categoria" name="categoria">
                        <option value="garden" selected>Suite Garden View</option>
                        <option value="ocean">Suite Ocean View</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="checkin"><i class="fa-solid fa-calendar-day"></i> Fecha Check-in:</label>
                    <input type="date" id="checkin" name="checkin" min="2026-02-01" max="2026-02-28" value="2026-02-05">
                </div>
                <div class="form-group">
                    <label for="checkout"><i class="fa-solid fa-calendar-day"></i> Fecha Check-out:</label>
                    <input type="date" id="checkout" name="checkout" min="2026-02-01" max="2026-02-28" value="2026-02-08">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="adultos"><i class="fa-solid fa-user"></i> Adultos (12+):</label>
                    <input type="number" id="adultos" name="adultos" min="1" max="3" value="2" step="1">
                </div>
                <div class="form-group">
                    <label for="ninos05"><i class="fa-solid fa-baby"></i> Niños 0–5 años (gratis):</label>
                    <input type="number" id="ninos05" name="ninos05" min="0" max="3" value="0" step="1">
                </div>
                <div class="form-group">
                    <label for="ninos617"><i class="fa-solid fa-child"></i> Niños 6–17 años:</label>
                    <input type="number" id="ninos617" name="ninos617" min="0" max="3" value="0" step="1">
                </div>
            </div>
        </div>

        <div class="calculadora-resultados">
            <h2><i class="fa-solid fa-receipt"></i> Estimación de Costo</h2>

            <div class="resultado-item">
                <span class="resultado-label">Número de Noches:</span>
                <span class="resultado-valor" id="numNoches">--</span>
            </div>

            <div class="resultado-item">
                <span class="resultado-label">Tarifa por Noche (habitación):</span>
                <span class="resultado-valor" id="tarifaNoche">--</span>
            </div>

            <div class="resultado-item">
                <span class="resultado-label">Composición:</span>
                <span class="resultado-valor" id="detalleOcupacion">--</span>
            </div>

            <div class="resultado-item total">
                <span class="resultado-label">Tarifa Total Estimada:</span>
                <span class="resultado-valor" id="tarifaTotal">--</span>
            </div>

            <p class="nota-calculadora">
                *Tarifas estimadas por habitación, por noche, en pesos mexicanos (MXN), sujetas a disponibilidad y cambios. Incluyen impuestos y plan All-Fun Inclusive®. Los valores se redondean al entero superior. Esta es una herramienta de estimación; por favor, contáctanos directamente para que te compartamos el link de nuestro micrositio para reservar.

</p>
            <p id="alerta" style="color:#b00020;font-weight:600;"></p>
        </div>

        <div class="navegacion-volver">
            <a href="index.html" class="boton-volver">&larr; Volver a la Página Principal</a>
        </div>
    </div>

    <script>
        // === TARIFAS DEL CONTRATO (por persona, por noche) ===
        // Suite Garden View y Suite Ocean View (valores de tu tabla)
        // sencilla = 1 adulto solo en habitación
        // doble = tarifa por persona cuando hay 2 adultos (se multiplica por 2)
        // adicional = adulto adicional (3er adulto)
        // menor = 6–17 años (mismo importe que adicional en tu tabla)
        const tarifas = {
            garden: { nombre: "Suite Garden View", sencilla: 10020.00, doble: 8078.70, adicional: 6060.00, menor: 6060.00 },
            ocean:  { nombre: "Suite Ocean View",  sencilla: 12200.00, doble: 9842.70, adicional: 7380.00, menor: 7380.00 }
        };

        const formatterMXN = new Intl.NumberFormat('es-MX', {
            style: 'currency',
            currency: 'MXN',
            minimumFractionDigits: 0,
            maximumFractionDigits: 0
        });

        function calcularTarifa() {
            const categoria = document.getElementById('categoria').value;
            const checkinStr = document.getElementById('checkin').value;
            const checkoutStr = document.getElementById('checkout').value;
            const adultos = parseInt(document.getElementById('adultos').value) || 0;
            const ninos05 = parseInt(document.getElementById('ninos05').value) || 0;
            const ninos617 = parseInt(document.getElementById('ninos617').value) || 0;

            const alerta = document.getElementById('alerta');
            alerta.textContent = "";

            // Validación básica
            if (!checkinStr || !checkoutStr || adultos <= 0) {
                pintar("--", "--", "--", "");
                return;
            }

            const checkinDate = new Date(checkinStr);
            const checkoutDate = new Date(checkoutStr);
            const checkinUTC = Date.UTC(checkinDate.getUTCFullYear(), checkinDate.getUTCMonth(), checkinDate.getUTCDate());
            const checkoutUTC = Date.UTC(checkoutDate.getUTCFullYear(), checkoutDate.getUTCMonth(), checkoutDate.getUTCDate());

            if (checkoutUTC <= checkinUTC) {
                alerta.textContent = "La fecha de Check-out debe ser posterior a la fecha de Check-in.";
                pintar("--", "--", "--", "");
                return;
            }

            const diffTime = Math.abs(checkoutUTC - checkinUTC);
            const noches = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            // Validaciones de ocupación
            const totalPersonas = adultos + ninos05 + ninos617;
            if (totalPersonas > 4) {
                alerta.textContent = "Ocupación máxima por habitación: 4 personas.";
                pintar(noches, "--", "--", `Adultos: ${adultos}, 0–5: ${ninos05}, 6–17: ${ninos617}`);
                return;
            }
            if (adultos > 3) {
                alerta.textContent = "Máximo 3 adultos por habitación (sugerido por políticas de ocupación).";
            }

            const t = tarifas[categoria];
            let tarifaNochePrecisa = 0;

            // Cálculo base según número de adultos
            if (adultos === 1) {
                // 1 adulto paga sencilla; menores 6–17 se cobran; 0–5 gratis
                tarifaNochePrecisa = t.sencilla + (ninos617 * t.menor);
            } else if (adultos === 2) {
                // 2 adultos pagan doble por persona (×2); menores 6–17 se cobran
                tarifaNochePrecisa = (t.doble * 2) + (ninos617 * t.menor);
            } else if (adultos >= 3) {
                // 2 adultos base doble×2 + adultos extra como adicional; menores 6–17 se cobran
                const adultosAdicionales = adultos - 2;
                tarifaNochePrecisa = (t.doble * 2) + (adultosAdicionales * t.adicional) + (ninos617 * t.menor);
            }

            // Niños 0–5 no suman costo (ninos05 * 0)

            const tarifaTotalPrecisa = tarifaNochePrecisa * noches;

            const tarifaNocheRedondeada = Math.ceil(tarifaNochePrecisa);
            const tarifaTotalRedondeada = Math.ceil(tarifaTotalPrecisa);

            const detalle = `Adultos: ${adultos}, 0–5: ${ninos05}, 6–17: ${ninos617} — ${t.nombre}`;

            pintar(noches, formatterMXN.format(tarifaNocheRedondeada), formatterMXN.format(tarifaTotalRedondeada), detalle);
        }

        function pintar(noches, tarifaNoche, tarifaTotal, detalle) {
            document.getElementById('numNoches').textContent = noches;
            document.getElementById('tarifaNoche').textContent = tarifaNoche;
            document.getElementById('tarifaTotal').textContent = tarifaTotal;
            document.getElementById('detalleOcupacion').textContent = detalle;
        }

        // Listeners
        document.getElementById('categoria').addEventListener('change', calcularTarifa);
        document.getElementById('checkin').addEventListener('change', calcularTarifa);
        document.getElementById('checkout').addEventListener('change', calcularTarifa);
        document.getElementById('adultos').addEventListener('input', calcularTarifa);
        document.getElementById('ninos05').addEventListener('input', calcularTarifa);
        document.getElementById('ninos617').addEventListener('input', calcularTarifa);

        document.addEventListener('DOMContentLoaded', calcularTarifa);
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="menu.js"></script>
</body>
</html>